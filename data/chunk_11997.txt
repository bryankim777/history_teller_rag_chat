고려-거란 전쟁에서도 입장에 따라 서로 다른 편에 참전하였다. 고려 조정은 이런 상황에서 오판을 내렸
던 것이다.
그러나 여진이 다시 거란의 침입을 알려오자 비로소 상황이 급한 것을 인식하고 군사를 소집하여 전쟁
준비에 돌입하였다. 지휘관으로는 박양유(朴良柔)를 상군사(上軍使)로, 내사시랑(內史侍郞) 서희(徐熙)
를 중군사(中軍使)로, 문하시랑(⾨下侍郞) 최량(崔亮)을 하군사(下軍使)로 삼아 거란군을 방어하게 하
였다. 관련사료
그리고 국왕 성종이 직접 서경(西京)까지 올라가 전쟁을 준비하였다. 그러나 고려는 초반에 봉산군(蓬
⼭郡)을 잃고 선봉인 윤서안(尹庶顔)이 사로잡히는 패배를 겪었다. 안북대도호부[안북부](安北⼤都護
府)까지 올라가려 했던 성종은 이에 서경에 머무르게 되었다. 관련사료
봉산군의 함락 소식에 서희는 즉시 군대를 이끌고 구원에 나서려 하였다. 그러나 이 때 소항덕이 내건
침입의 구호를 보고, 서희는 강화 협상의 여지가 있음을 간파하였다. 당시 소항덕은 “우리 거란이 이미
고구려의 옛 땅을 차지했는데, 너희가 우리의 경계를 침략하니 우리가 토벌하러 온 것이다.”라는 주장과
“우리가 이미 천하를 통일하였으니, 아직 항복하지 않은 자는 반드시 소탕할 것이다. 즉시 항복하라.”라
는 요구를 하였다. 고려 조정에서는 서희의 견해를 따라 거란군에 사신을 파견해 침입의 이유를 물었다.