지원군을 거느리고 와서 지채문은 서경을 장악하고 거란군에 맞설 준비를 할 수 있었다. 관련사료
본격적인 서경 전투는 거란의 성종이 개성유수(開城留守)로 임명한 마보우(⾺保佑)와 그 호위병들이 서
경에 도착하면서 시작되었다. 먼저 기병 200명이 서경 북문에 이르러 다시금 항복을 권유하자, 탁사정
과 지채문은 날랜 기병들을 거느리고 출격하여 100여 명을 베고 나머지는 모두 포로로 잡는 전과를 거
두었다. 다음으로 거란 장수 을름(⼄凜)이 기병 1,000명으로 마보우를 호위하며 도착하니, 이번에도 지
채문이 선봉이 되어 을름을 격파하였다. 고려군의 연이은 승리로 인해 두려움에 떨던 서경의 여론이 안
정될 수 있었다. 관련사료
거란 성종이 수많은 거란군을 거느리고 서경에 도착하자 다시금 전투가 벌어졌다. 첫 날에는 고려군이
분전하여 승리하였고, 이튿날에는 지채문이 거란군을 격파하니 사기가 크게 올라 서경의 장수들이 도망
가는 거란군을 추격해 나갔다. 하지만 이는 거란군의 함정이었다. 마탄(⾺灘)이라는 여울에 이르자 거란
군은 언제 도망갔냐는 듯이 반전하여 추격에 정신이 팔렸던 고려군을 공격하였고, 대패한 고려군의 장
수들이 사방으로 도망치고 서경이 포위당하는 등 전세가 역전되고 말았다. 서경을 지키고 있던 탁사정
역시 동료 대도수(⼤道秀)를 속여 미끼로 내보내고서는 도망치는 바람에, 1차 고려-거란 전쟁 때 활약하