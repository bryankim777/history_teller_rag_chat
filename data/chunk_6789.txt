대동강)을 거슬러 올라가 평양을 공격하려 하였다.
그러나 수의 대군은 쉽사리 고구려를 제압하지 못하였다. 우선 양제가 이끄는 본대가 요동성(遼東城)을
공격했으나 강한 저항에 부딪혀 성을 함락할 수 없었고, 요하를 건너지 못하였다. 또한 내호아의 수군도
평양성 전투에서 크게 패배하였다. 6월까지 고구려의 항전에 막혀 대군이 별다른 성과를 내지 못하고
요동성에서 발이 묶이자, 양제는 우중문(于仲⽂), 우문술(宇⽂述) 등을 지휘관으로 305,000명의 별동
대를 조직하여, 바로 평양을 공격하는 작전을 시행하였다. 워낙 대군이어서 신속한 움직임은 힘들었고
전쟁이 길어지면 대군의 약점이 드러날 수밖에 없었기에 선택한 방안이었다. 하지만 신속한 움직임을
위해 선발한 별동대가 30만이었다는 것은 수의 군대가 얼마나 대규모였는지를 단적으로 보여준다.
별동대였지만 그 규모가 매우 컸던 지라 고구려군은 정면 승부를 할 수 없었다. 주요 교통로 상의 성을
거점으로 수비에 집중하는 전술을 펼쳐 적의 발목을 잡을 뿐이었다. 수의 별동대는 평양으로 진격해 갔
고 이윽고 압록강에 이르렀다. 하지만 이미 식량이 떨어져가고 있었다. 그리고 이때에 을지문덕의 이름
이 처음 등장한다. 을지문덕은 항복하는 척 하며 적진에 가 정보를 탐지하고 돌아갔다. 그런데 별동대를
이끌던 우중문은 양제에게 을지문덕과 관련한 비밀 명령을 받은 상태였다. 고구려왕이나 을지문덕이 수